<!DOCTYPE html>
<html>

<head>
  <!-- <link rel="stylesheet" href="style.css"> -->
  <script src="assets/js/jquery.min.js"></script>
  <script src="assets/js/Session.js"></script>
  <link href="assets/css/print.css" rel="stylesheet">
  <!-- <script>Session.Check();</script> -->
</head>

<body>
  <div class="ticket">
    <table>
        <tbody>
          <tr><td><label>----------------------------------------------------------</label></td></tr>
          
          <tr style="line-height:10px;font-family:Bahnschrift Condensed; text-align: center;"><td>
            TROPICAL SNO. <label id="bodega"></label>
          </td></tr>
          <tr><td><label>----------------------------------------------------------</label></td></tr>
          <tr style="line-height:10px;font-family:Bahnschrift Condensed; text-align: center;"><td>DISTRIBUCION # <label id=orden></label></label></td></tr>
          <tr style="line-height:10px;font-family:Bahnschrift Condensed; text-align: center;"><td>Fecha: <label id="fechaDistribucion"></label></td></tr>
          <tr style="line-height:10px;font-family:Bahnschrift Condensed; text-align: center;"><td>Usuario: <label id="usuario"></label></td></tr>
        </tbody>
      </table>
    <table>
      <tbody id="tableBody-TicketDistribucion">
      </tbody>
    </table>
    <table style="line-height:10px;font-family:Bahnschrift Condensed; width:100%;">
        <tbody id="tableBody-TicketTotal">
        </tbody>
    </table>
    <p style="line-height:10px;font-family:Bahnschrift Condensed;" class="centrado">Orden Distribuida...</p>
    </br>
    
  </div>
  <script src="assets/js/Distribucion.js"></script>
</body>

</html>

<script>
    $(document).ready(function () {
      var tipoBodega = localStorage.getItem("lsTipoBodega");
      $("#orden").text(localStorage.getItem("lsOrden"));
      $("#fechaDistribucion").text(localStorage.getItem("lsFechaDistribucion"));
      $("#bodega").text(localStorage.getItem("lsBodega"));
      $("#descripcion").text(localStorage.getItem("lsDescripcion"));
      $("#usuario").text(localStorage.getItem("lsUsuarioDistribucion"));
      var listaProducto = localStorage.getItem("lsListaProducto");
      listaProducto = JSON.parse(listaProducto);
      
      if (tipoBodega=="interna") {
        $('#tableBody-TicketDistribucion').append(`  
          <tr><td colspan="2"><label>----------------------------------------------------------</label></td></tr>
          <tr>
            <td style="line-height:10px;font-family:Bahnschrift Condensed; width:10%; text-align:left;">CN</td>
            <td style="line-height:10px;font-family:Bahnschrift Condensed; width:90%; text-align:left;">Detalle</td>
          </tr>
          <tr><td colspan="2"><label>----------------------------------------------------------</label></td></tr>
        `);
        $.each(listaProducto, function (i, item) {
          $('#tableBody-TicketDistribucion').append(`
                <tr> 
                    <td style="line-height:10px;font-family:Bahnschrift Condensed; width:10%; text-align:left;">${item.cantidad}</td>
                    <td style="line-height:10px;font-family:Bahnschrift Condensed; width:90%; text-align:left;">${item.nombre}</td>
                </tr>
          `);
        });  
      }
      else{
        $('#tableBody-TicketDistribucion').append(`  
          <tr><td colspan="3"><label>----------------------------------------------------------</label></td></tr>
          <tr>
            <td style="line-height:10px;font-family:Bahnschrift Condensed; width:10%; text-align:left;">CN</td>
            <td style="line-height:10px;font-family:Bahnschrift Condensed; width:60%; text-align:left;">Detalle</td>
            <td style="line-height:10px;font-family:Bahnschrift Condensed; width:30%; text-align:right;">Precio</td>
          </tr>
          <tr><td colspan="3"><label>----------------------------------------------------------</label></td></tr>
        `);
        $.each(listaProducto, function (i, item) {
          $('#tableBody-TicketDistribucion').append(`
                <tr> 
                    <td style="line-height:10px;font-family:Bahnschrift Condensed; width:10%; text-align:left;">${item.cantidad}</td>
                    <td style="line-height:10px;font-family:Bahnschrift Condensed; width:60%; text-align:left;">${item.nombre}</td>
                    <td style="line-height:10px;font-family:Bahnschrift Condensed; width:30%; text-align:right;">
                    ${parseFloat(item.precioVenta).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}</td>
                  </tr>
          `);
        }); 
        $('#tableBody-TicketTotal').append(`
        <tr><td colspan="2"><label>----------------------------------------------</label></td></tr>
        <tr>
          <td><label style="line-height:10px;font-family:Bahnschrift Condensed; width:65%; text-align:left;">Sub Total</label></td>
          <td style="line-height:10px;font-family:Bahnschrift Condensed; width:35%; text-align:right;">
          ${localStorage.getItem("lsSubTotal")}</td>
        </tr>
        <tr>
          <td><label style="line-height:10px;font-family:Bahnschrift Condensed; width:65%; text-align:left;">Descuento</labe></td>
          <td style="line-height:10px;font-family:Bahnschrift Condensed; width:35%; text-align:right;">
          ${localStorage.getItem("lsPorcentajeDescuento")}</td>
        </tr>
        <tr>
          <td><label style="line-height:10px;font-family:Bahnschrift Condensed; width:65%; text-align:left;">Impuesto de Ventas</label></td>
          <td id="efectivo" style="line-height:10px;font-family:Bahnschrift Condensed; width:35%; text-align:right;">
          ${localStorage.getItem("lsPorcentajeIva")}</td>
        </tr>
        <tr>
          <td><label style="line-height:10px;font-family:Bahnschrift Condensed; width:65%; text-align:left;">TOTAL</label></td>
          <td id="vuelto" style="line-height:10px;font-family:Bahnschrift Condensed; width:35%; text-align:right;">
          ${localStorage.getItem("lsTotal")}</td>
        </tr>
        <tr><td colspan="2"><label>----------------------------------------------</label></td></tr>
      `); 
      }
      window.print();
      localStorage.setItem("lsPrintOK","OK");
      // location.href ="/Tropical/Distribucion.html";
      location.href ="/Distribucion.html";
  });  
</script>
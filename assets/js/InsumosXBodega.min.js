class InsumoBodega{constructor(id,idBodega,codigo,nombre,descripcion,saldoCantidad,saldoCosto,costoPromedio){this.id=id||null,this.idBodega=idBodega||null,this.codigo=codigo||"",this.nombre=nombre||"",this.descripcion=descripcion||"",this.saldoCantidad=saldoCantidad||0,this.saldoCosto=saldoCosto||0,this.costoPromedio=costoPromedio||0}get tUpdate(){return this.update="update"}get tSelect(){return this.select="select"}set viewEventHandler(_t){this.viewType=_t}get Read(){var miAccion=null==this.id?"ReadAll":"Read";"ReadAll"==miAccion&&0==$("#tInsumo tbody").length||$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:miAccion,id:this.id}}).done(function(e){insumobodega.Reload(e)}).fail(function(e){insumobodega.showError(e)})}get ReadCompleto(){var miAccion="ReadCompleto";$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:miAccion,id:this.id}}).done(function(e){insumobodega.Reload(e)}).fail(function(e){insumobodega.showError(e)})}get ReadByBodega(){var miAccion=null==this.id?"ReadAll":"Read";"ReadAll"==miAccion&&0==$("#tInsumo tbody").length||$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:miAccion,idBodega:this.idBodega}}).done(function(e){insumobodega.Reload(e)}).fail(function(e){insumobodega.showError(e)})}get Save(){$("#btnSubmit").attr("disabled","disabled");var miAccion=null==this.id?"Create":"Update";this.saldoCantidad=$("#saldoCantidad").val(),this.saldoCosto=$("#saldoCosto").val(),this.costoPromedio=$("#costoPromedio").val(),$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:miAccion,obj:JSON.stringify(this)}}).done(insumobodega.showInfo).fail(function(e){insumobodega.showError(e)}).always(function(){$("#btnSubmit").removeAttr("disabled"),(insumobodega=new InsumoBodega).ClearCtls(),insumobodega.Read})}Reload(e){null==this.id?this.ShowAll(e):this.ShowItemData(e)}showInfo(){$(".close").click(),swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}showError(e){var data=JSON.parse(e.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+data.code+"): "+data.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}ClearCtls(){$("#producto").val(""),$("#cantidad").val(""),$("#costo").val("")}ShowAll(e){var t=$("#tInsumo").DataTable();t.clear();var data=JSON.parse(e);$.each(data,function(i,item){item.saldoCosto="¢"+parseFloat(item.saldoCosto).toFixed(2).toString(),item.costoPromedio="¢"+parseFloat(item.costoPromedio).toFixed(2).toString()}),t.rows.add(data),t.draw()}UpdateEventHandler(){insumobodega.id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),insumobodega.Read}ShowItemData(e){this.ClearCtls();var data=JSON.parse(e)[0];insumobodega=new InsumoBodega(data.id,data.idBodega,data.codigo,data.nombre,data.descripcion,data.saldoCantidad,data.saldoCosto,data.costoPromedio),$("#codigo").val(insumobodega.codigo),$("#nombre").val(insumobodega.nombre),$("#descripcion").val(insumobodega.descripcion),$("#saldoCantidad").val(insumobodega.saldoCantidad),$("#saldoCosto").val(insumobodega.saldoCosto),$("#costoPromedio").val(insumobodega.costoPromedio),$("#myModalLabel").html("<h1>"+insumobodega.nombre+"<h1>")}DeleteEventHandler(){insumobodega.id=$(this).parents("tr").find(".itemId").text(),swal({title:"Eliminar?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(result=>{result.value&&insumobodega.Delete})}setTable(buttons=!0,completo=!1){jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(a){return a="-"===a||""===a?0:a.replace(/[^\d\-\.]/g,""),parseFloat(a)},"formatted-num-asc":function(a,b){return a-b},"formatted-num-desc":function(a,b){return b-a}}),$("#tInsumo").DataTable({responsive:!0,destroy:!0,order:[[1,"asc"]],dom:"Bfrtip",buttons:[{extend:"excelHtml5",exportOptions:{columns:[1,2,3,4,5]},messageTop:"Inventario por Agencia"},{extend:"pdfHtml5",orientation:"landscape",messageTop:"Inventario por Agencia",exportOptions:{columns:[1,2,3,4,5]}}],language:{infoEmpty:"Sin Productos Agencia",emptyTable:"Sin Productos Agencia",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columnDefs:[{className:"text-right",targets:[4,5]}],columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"AGENCIA",data:"agencia",visible:completo},{title:"CODIGO",data:"codigo"},{title:"NOMBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"CANTIDAD",data:"saldoCantidad"},{title:"COSTO",data:"saldoCosto",visible:!1},{title:"COSTO PROMEDIO",data:"costoPromedio",visible:!1},{title:"ACCION",orderable:!1,searchable:!1,visible:buttons,className:"buttons",width:"5%",mRender:function(){return'<a class="delete"> <i class="glyphicon glyphicon-trash"> </i>  </a>'}}]})}Init(){var validator=new FormValidator({events:["blur","input","change"]},document.forms.frmInsumo);$("#frmInsumo").submit(function(e){var validatorResult;return e.preventDefault(),validator.checkAll(this).valid&&insumobodega.Save,!1}),$("#frmInsumo").length>0&&(document.forms.frmInsumo.onreset=function(e){validator.reset()})}setTableInventarioInsumoReporte(){jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(a){return a="-"===a||""===a?0:a.replace(/[^\d\-\.]/g,""),parseFloat(a)},"formatted-num-asc":function(a,b){return a-b},"formatted-num-desc":function(a,b){return b-a}}),this.tablainsumo=$("#dsInsumoReporte").DataTable({responsive:!0,destroy:!0,order:[1,"desc"],dom:"Bfrtip",buttons:[{extend:"excelHtml5",exportOptions:{columns:[1,3,5,7,9,10,11,12,13,14,15]},messageTop:"Movimientos de Materia Prima"},{extend:"pdfHtml5",orientation:"landscape",exportOptions:{columns:[1,3,5,7,9,10,11,12,13,14,15]}}],language:{infoEmpty:"Sin movimientos de Materia Prima",emptyTable:"Sin movimientos de Materia Prima",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{title:"ID",data:"id",className:"itemId",width:"auto",searchable:!1},{title:"FECHA",data:"fecha",width:"auto"},{title:"ENTRADA",data:"ordenEntrada",width:"auto"},{title:"SALIDA",data:"ordenSalida",width:"auto"},{title:"ID INSUMO",data:"idInsumo",visible:!1},{title:"INSUMO",data:"insumo",width:"auto"},{title:"ENTRADA",data:"entrada",width:"auto",mRender:function(e){return null==e?"0":e}},{title:"SALIDA",data:"salida",width:"auto",mRender:function(e){return null==e?"0":e}},{title:"SALDO",data:"saldo",width:"auto"},{title:"COSTO ADQUISICION",data:"costoAdquisicion",width:"auto",type:"formatted-num",mRender:function(e){return null==e?"¢0":"¢"+parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR ENTRADA",data:"valorEntrada",width:"auto",type:"formatted-num",mRender:function(e){return null==e?"¢0":"¢"+parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR SALIDA",data:"valorSalida",width:"auto",type:"formatted-num",mRender:function(e){return null==e?"¢0":"¢"+parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR SALDO",data:"valorSaldo",width:"auto",type:"formatted-num",mRender:function(e){return null==e?"¢0":"¢"+parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"COSTO PROMEDIO",data:"costoPromedio",width:"auto",type:"formatted-num",mRender:function(e){return null==e?"¢0":"¢"+parseFloat(e).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]})}CargaInsumoRango(){var referenciaCircular=insumobodega.tablainsumo;insumobodega.tablainsumo=[],$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:"ReadAllbyRange",obj:JSON.stringify(insumobodega)}}).done(function(e){insumobodega.tablainsumo=referenciaCircular,insumobodega.ShowAllInventario(e)})}ShowAllInventario(e){var t=$("#dsInsumoReporte").DataTable();t.rows().count(),t.clear(),t.rows.add(JSON.parse(e)),t.draw()}}let insumobodega=new InsumoBodega;
class InsumoBodega{constructor(t,o,e,a,n,i,d,s,r){this.id=t||null,this.idBodega=o||null,this.codigo=e||"",this.nombre=a||"",this.descripcion=n||"",this.saldoCantidad=i||0,this.saldoCosto=d||0,this.costoPromedio=s||0,this.agencia=r||""}get tUpdate(){return this.update="update"}get tSelect(){return this.select="select"}set viewEventHandler(t){this.viewType=t}get Read(){var t=null==this.id?"ReadAll":"Read";"ReadAll"==t&&0==$("#tInsumo tbody").length||$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:t,id:this.id}}).done(function(t){insumobodega.Reload(t)}).fail(function(t){insumobodega.showError(t)})}get ReadCompleto(){var t="ReadCompleto";"ReadAll"==t&&0==$("#tInsumo tbody").length||$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:t,id:this.id}}).done(function(t){insumobodega.Reload(t)}).fail(function(t){insumobodega.showError(t)})}get ReadByBodega(){var t=null==this.id?"ReadAll":"Read";"ReadAll"==t&&0==$("#tInsumo tbody").length||$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:t,idBodega:this.idBodega}}).done(function(t){insumobodega.Reload(t)}).fail(function(t){insumobodega.showError(t)})}get Save(){$("#btnSubmit").attr("disabled","disabled");var t=null==this.id?"Create":"Update";this.saldoCantidad=$("#saldoCantidad").val(),this.saldoCosto=$("#saldoCosto").val(),this.costoPromedio=$("#costoPromedio").val(),null!=arrInventario&&(this.arrInventario=new Array,this.arrInventario=arrInventario),$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:t,obj:JSON.stringify(this)}}).done(insumobodega.showInfo).fail(function(t){insumobodega.showError(t)}).always(function(){$("#btnSubmit").removeAttr("disabled"),insumobodega=new InsumoBodega,insumobodega.ClearCtls(),insumobodega.ReadCompleto})}Reload(t){null==this.id?this.ShowAll(t):this.ShowItemData(t)}showInfo(){$(".close").click(),swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}showError(t){var o=JSON.parse(t.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+o.code+"): "+o.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}ClearCtls(){$("#codigo").val(""),$("#nombre").val(""),$("#descripcion").val(""),$("#producto").val(""),$("#saldoCantidad").val(""),$("#saldoCosto").val(""),$("#costoPromedio").val(""),$("#cantidadMod").val("0"),arrInventario=new Array}ShowAll(t){var o=$("#tInsumo").DataTable();if(0==o.rows().count()){o.clear();var e=JSON.parse(t);$.each(e,function(t,o){o.saldoCosto="¢"+parseFloat(o.saldoCosto).toFixed(2).toString(),o.costoPromedio="¢"+parseFloat(o.costoPromedio).toFixed(2).toString()}),o.rows.add(e),o.draw(),$(document).on("click","#tInsumo tbody tr",-1!=document.URL.indexOf("InsumosBodegaTodos.html")?insumobodega.UpdateEventHandler:null)}else{o.clear();e=JSON.parse(t);$.each(e,function(t,o){o.saldoCosto="¢"+parseFloat(o.saldoCosto).toFixed(2).toString(),o.costoPromedio="¢"+parseFloat(o.costoPromedio).toFixed(2).toString()}),o.rows.add(e),o.draw()}}UpdateEventHandler(){insumobodega.id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),insumobodega.Read}ShowItemData(t){this.ClearCtls();var o=JSON.parse(t)[0];insumobodega=new InsumoBodega(o.id,o.idBodega,o.codigo,o.producto,o.descripcion,o.saldoCantidad,o.saldoCosto,o.costoPromedio,o.agencia),$("#codigo").val(insumobodega.codigo),$("#nombre").val(insumobodega.nombre),$("#descripcion").val(insumobodega.descripcion),$("#saldoCantidad").val(insumobodega.saldoCantidad),$("#saldoCosto").val(insumobodega.saldoCosto),$("#costoPromedio").val(insumobodega.costoPromedio),$("#myModalLabel").html("<h1>"+insumobodega.agencia+"<h1>"),$(".bs-bodega-modal-lg").modal("toggle")}DeleteEventHandler(){insumobodega.id=$(this).parents("tr").find(".itemId").text(),swal({title:"Eliminar?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(t=>{t.value&&insumobodega.Delete})}setTable(t=!0,o=!1){jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(t){return t="-"===t||""===t?0:t.replace(/[^\d\-\.]/g,""),parseFloat(t)},"formatted-num-asc":function(t,o){return t-o},"formatted-num-desc":function(t,o){return o-t}}),$("#tInsumo").DataTable({responsive:!0,destroy:!0,order:[[5,"desc"]],dom:"Bfrtip",buttons:[{extend:"excelHtml5",exportOptions:{columns:[1,2,3,4,5]},messageTop:"Inventario por Agencia"},{extend:"pdfHtml5",orientation:"landscape",messageTop:"Inventario por Agencia",exportOptions:{columns:[1,2,3,4,5]}}],language:{infoEmpty:"Sin Productos Agencia",emptyTable:"Sin Productos Agencia",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columnDefs:[{className:"text-right",targets:[4,5]}],columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"AGENCIA",data:"agencia",visible:o},{title:"CODIGO",data:"codigo"},{title:"NOMBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"CANTIDAD",data:"saldoCantidad"},{title:"COSTO",data:"saldoCosto",visible:!1},{title:"COSTO PROMEDIO",data:"costoPromedio",visible:!1},{title:"ACCION",orderable:!1,searchable:!1,visible:t,className:"buttons",width:"5%",mRender:function(){return'<a class="delete"> <i class="glyphicon glyphicon-trash"> </i>  </a>'}}]})}Init(){var t=new FormValidator({events:["blur","input","change"]},document.forms.frmInsumo);$("#frmInsumo").submit(function(o){o.preventDefault();var e=t.checkAll(this);return e.valid&&insumobodega.Save,!1}),$("#frmInsumo").length>0&&(document.forms.frmInsumo.onreset=function(o){t.reset()})}setTableInventarioInsumoReporte(){jQuery.extend(jQuery.fn.dataTableExt.oSort,{"formatted-num-pre":function(t){return t="-"===t||""===t?0:t.replace(/[^\d\-\.]/g,""),parseFloat(t)},"formatted-num-asc":function(t,o){return t-o},"formatted-num-desc":function(t,o){return o-t}}),this.tablainsumo=$("#dsInsumoReporte").DataTable({responsive:!0,destroy:!0,order:[1,"desc"],dom:"Bfrtip",buttons:[{extend:"excelHtml5",exportOptions:{columns:[1,3,5,7,9,10,11,12,13,14,15]},messageTop:"Movimientos de Materia Prima"},{extend:"pdfHtml5",orientation:"landscape",exportOptions:{columns:[1,3,5,7,9,10,11,12,13,14,15]}}],language:{infoEmpty:"Sin movimientos de Materia Prima",emptyTable:"Sin movimientos de Materia Prima",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{title:"ID",data:"id",className:"itemId",width:"auto",searchable:!1},{title:"FECHA",data:"fecha",width:"auto"},{title:"BODEGA",data:"agencia",visible:!0},{title:"ENTRADA",data:"ordenEntrada",width:"auto"},{title:"SALIDA",data:"ordenSalida",width:"auto"},{title:"ID INSUMO",data:"idInsumo",visible:!1},{title:"INSUMO",data:"insumo",width:"auto"},{title:"ENTRADA",data:"entrada",width:"auto",mRender:function(t){return null==t?"0":t}},{title:"SALIDA",data:"salida",width:"auto",mRender:function(t){return null==t?"0":t}},{title:"SALDO",data:"saldo",width:"auto"},{title:"COSTO ADQUISICION",data:"costoAdquisicion",width:"auto",type:"formatted-num",mRender:function(t){return null==t?"¢0":"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR ENTRADA",data:"valorEntrada",width:"auto",type:"formatted-num",mRender:function(t){return null==t?"¢0":"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR SALIDA",data:"valorSalida",width:"auto",type:"formatted-num",mRender:function(t){return null==t?"¢0":"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"VALOR SALDO",data:"valorSaldo",width:"auto",type:"formatted-num",mRender:function(t){return null==t?"¢0":"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"COSTO PROMEDIO",data:"costoPromedio",width:"auto",type:"formatted-num",mRender:function(t){return null==t?"¢0":"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]})}CargaInsumoRango(){var t=insumobodega.tablainsumo;insumobodega.tablainsumo=[],$.ajax({type:"POST",url:"class/InsumosXBodega.php",data:{action:"ReadAllbyRange",obj:JSON.stringify(insumobodega)}}).done(function(o){insumobodega.tablainsumo=t,insumobodega.ShowAllInventario(o)})}ShowAllInventario(t){var o=$("#dsInsumoReporte").DataTable();o.rows().count(),o.clear(),o.rows.add(JSON.parse(t)),o.draw()}}let insumobodega=new InsumoBodega;
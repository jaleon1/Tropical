var url,t=null,mouseX,mouseY;function Login(){$("#btnLogin").attr("disabled","disabled"),$.ajax({type:"POST",url:"class/Usuario.php",data:{action:"Login",username:$("#username").val(),password:$("#password").val(),ip:localip,beforeSend:function(){$("#error").fadeOut()}}}).done(function(e){var data=JSON.parse(e);"login"==data.status?data.bodegas.length>1?(url=data.url,ShowAll(data),$("#modal-bodega").modal("toggle")):data.url&&(location.href=data.url||"Dashboard.html"):"inactivo"==data.status?$("#error").fadeIn(500,function(){$("#error").html('                    \n                    <div class="alert alert-danger alert-dismissible fade in" role="alert">\n                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>\n                        Usuario <strong>INACTIVO</strong>.\n                    </div>\n                ')}):"noexiste"==data.status?$("#error").fadeIn(500,function(){$("#error").html('                    \n                    <div class="alert alert-danger alert-dismissible fade in" role="alert">\n                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>\n                        Usuario <strong>NO EXISTE</strong>, favor registrarse.\n                    </div>\n                ')}):"noip"==data.status?swal({type:"error",title:"Número de IP no autorizada",text:"ip: "+localip,showConfirmButton:!1,timer:3e3}):$("#error").fadeIn(500,function(){$("#error").html('\n                    <div class="alert alert-danger alert-dismissible fade in" role="alert">\n                        <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">×</span></button>\n                        Usuario / Contraseña <strong>Inválidos</strong>.\n                    </div>\n                ')})}).fail(function(e){showError(e)}).always(function(){$("#btnLogin").removeAttr("disabled")})}function showError(e){var data=JSON.parse(e.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+data.code+"): "+data.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}function ShowAll(data){t=$("#dsItemsBodega").DataTable({responsive:!0,pagging:!1,destroy:!0,searching:!1,bPaginate:!1,bLengthChange:!1,info:!1,data:data.bodegas,language:{infoEmpty:"Sin Productos Ingresados",emptyTable:"Sin Productos Ingresados",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{data:"idBodega"},{data:"nombre",title:"Agencia"},{data:"local",title:"Local"}],columnDefs:[{targets:0,visible:!1,searchable:!1,className:"itemId"}]})}$(document).ready(function(){$(function(){"use strict";jqKeyboard.init()});var validator=new FormValidator({events:["blur","input","change"]},document.forms[0]);$("#frmLogin").submit(function(e){var validatorResult;return e.preventDefault(),validator.checkAll(this).valid&&Login(),!1}),$(document).mousemove(function(e){mouseX=e.pageX,mouseY=e.pageY}),$("#btnKeyboar").click(function(){$("#numPad").css({top:mouseY,left:mouseX+50}).fadeIn("slow"),selector=$("#username")}),document.forms[0].onreset=function(e){validator.reset()},$("#dsItemsBodega tbody").on("click","tr",function(){var data=t.row(this).data();$.ajax({type:"POST",destroy:!0,url:"class/Usuario.php",data:{action:"setBodega",idBodega:data.idBodega,nombre:data.nombre,local:data.local}}).done(function(e){url&&(location.href=data.url||"Dashboard.html")}).fail(function(e){showError(e)})})});
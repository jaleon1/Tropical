class Rol{constructor(id,nombre,descripcion,evento){this.id=id||null,this.nombre=nombre||"",this.descripcion=descripcion||"",this.listaEvento=evento||null}get Read(){NProgress.start();var miAccion=null==this.id?"ReadAll":"Read";"ReadAll"==miAccion&&0==$("#tRol tbody").length||$.ajax({type:"POST",url:"class/Rol.php",data:{action:miAccion,id:this.id}}).done(function(e){rol.Reload(e)}).fail(function(e){rol.showError(e)}).always(NProgress.done())}get Save(){NProgress.start(),$("#btnRol").attr("disabled","disabled");var miAccion=null==this.id?"Create":"Update";this.nombre=$("#nombre").val(),this.descripcion=$("#descripcion").val(),this.listaEvento=$("#evento > option:selected").map(function(){return this.value}).get(),$.ajax({type:"POST",url:"class/Rol.php",data:{action:miAccion,obj:JSON.stringify(this)}}).done(rol.showInfo).fail(function(e){rol.showError(e)}).always(function(){setTimeout('$("#btnRol").removeAttr("disabled")',1e3),(rol=new Rol).ClearCtls(),rol.Read,$("#nombre").focus(),NProgress.done()})}get Delete(){$.ajax({type:"POST",url:"class/Rol.php",data:{action:"Delete",id:this.id}}).done(function(e){var data=JSON.parse(e);0==data.status?swal({type:"success",title:"Eliminado!",showConfirmButton:!1,timer:1e3}):1==data.status?swal({type:"error",title:"No es posible eliminar...",text:"El registro que intenta eliminar tiene objetos relacionados"}):swal({type:"error",title:"Ha ocurrido un error...",text:"El registro no ha sido eliminado",footer:"<a href>Contacte a Soporte Técnico</a>"})}).fail(function(e){rol.showError(e)}).always(function(){(rol=new Rol).Read})}get List(){var miAccion="ReadAll";$.ajax({type:"POST",url:"class/Rol.php",data:{action:miAccion}}).done(function(e){rol.ShowList(e)}).fail(function(e){rol.showError(e)}).always(function(e){$("#rol").selectpicker("refresh")})}Reload(e){null==this.id?this.ShowAll(e):this.ShowItemData(e)}showInfo(){$(".close").click(),swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}showError(e){var data=JSON.parse(e.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+data.code+"): "+data.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}ClearCtls(){$("#id").val(""),$("#nombre").val(""),$("#descripcion").val(""),$("#evento option").prop("selected",!1),$("#evento").selectpicker("refresh")}ShowAll(e){var t=$("#tRol").DataTable();0==t.rows().count()?(t.clear(),t.rows.add(JSON.parse(e)),t.draw(),$(document).on("click",".delete",rol.DeleteEventHandler),$(document).on("click","#tRol tbody tr td:not(.buttons)",null==rol.viewType||rol.viewType==rol.tUpdate?rol.UpdateEventHandler:rol.SelectEventHandler)):(t.clear(),t.rows.add(JSON.parse(e)),t.draw())}UpdateEventHandler(){rol.id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),rol.Read}ShowItemData(e){this.ClearCtls();var data=JSON.parse(e);rol=new Rol(data.id,data.nombre,data.descripcion,data.listaEvento),$("#id").val(rol.id),$("#nombre").val(rol.nombre),$("#myModalLabel").html("<h1>"+rol.nombre+"<h1>"),$("#descripcion").val(rol.descripcion),$.each(rol.listaEvento,function(i,item){$("#evento option[value="+item.id+"]").prop("selected",!0)}),$("#evento").selectpicker("refresh"),$(".modal").modal("toggle")}ShowList(e){var data=JSON.parse(e);$.each(data,function(i,item){$("#rol").append(`\n                <option value=${item.id}>${item.nombre}</option>\n            `)})}DeleteEventHandler(){rol.id=$(this).parents("tr").find(".itemId").text(),swal({title:"Eliminar?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(result=>{result.value&&rol.Delete})}setTable(buttons=!0){$("#tRol").DataTable({responsive:!0,info:!1,order:[[1,"asc"]],language:{infoEmpty:"Sin Roles Registrados",emptyTable:"Sin Roles Registrados",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"NOMBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"ACCION",orderable:!1,searchable:!1,visible:buttons,className:"buttons",width:"5%",mRender:function(){return'<a class="delete" style="cursor: pointer;"> <i class="glyphicon glyphicon-trash"> </i>  </a>'}}]})}Init(){var validator=new FormValidator({events:["blur","input","change"]},document.forms[0]);$("#frmRol").submit(function(e){var validatorResult;return e.preventDefault(),validator.checkAll(this).valid&&rol.Save,!1}),document.forms[0].onreset=function(e){validator.reset()}}}let rol=new Rol;
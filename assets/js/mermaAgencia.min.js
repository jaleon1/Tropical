class MermaAgencia{constructor(id,idItem,cantidad,descripcion,fecha,idBodega){this.id=id||null,this.idBodega=idBodega||null,this.idItem=idItem||null,this.cantidad=cantidad||0,this.descripcion=descripcion||"",this.fecha=fecha||null}get Read(){NProgress.start();var miAccion=null==this.id?"ReadAll":"Read";"ReadAll"==miAccion&&0==$("#tMerma tbody").length||$.ajax({type:"POST",url:"class/mermaAgencia.php",data:{action:miAccion,id:this.id}}).done(function(e){merma.Reload(e)}).fail(function(e){merma.showError(e)}).always(NProgress.done())}showError(e){var data=JSON.parse(e.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+data.code+"): "+data.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}DeleteMerma(e){swal({title:"Devolver Merma de Agencia?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(result=>{result.value&&t.row($(e).parents("tr")).remove().draw()})}setTable(buttons=!0,nPaging=10){t=$("#tMerma").DataTable({responsive:!0,info:!1,iDisplayLength:nPaging,paging:!1,order:[2,"desc"],language:{infoEmpty:"Sin Registros Ingresados",emptyTable:"Sin Registros Ingresados",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"CODIGO",data:"codigo"},{title:"CONSECUTIVO",data:"consecutivo"},{title:"NOMBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"CANTIDAD",data:"cantidad"},{title:"OBSERVACIONES",data:"descripcion"},{title:"FECHA",data:"fecha"},{title:"Acción",orderable:!1,searchable:!1,mRender:function(){return'<a class="delete" style="cursor: pointer;" onclick="merma.DeleteMerma(this)" > <i class="glyphicon glyphicon-trash"> </i></a>'},visible:!0}]})}Reload(e){null==this.id?this.ShowAll(e):this.ShowItemData(e)}ShowAll(e){var t=$("#tMerma").DataTable();t.clear(),t.rows.add(JSON.parse(e)),$("td:eq(5)").attr({align:"right"}),t.order([1,"desc"]).draw()}showInfo(){swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}crear(){var miAccion="Create",listaok=!0;return merma.listaProducto=[],$("#tProducto tbody tr").each(function(i,item){var objlista=new Object;objlista.idProducto=$(item).find("td:eq(0)")[0].textContent,objlista.cantidad=$(item).find("td:eq(3) input").val(),null!=$(item).find("td:eq(4) input").val()&&""==$(item).find("td:eq(4) input").val()&&(swal({type:"warning",title:"Descripción...",text:"Debe digitar la descripción de la merma"}),listaok=!1),objlista.descripcion=$(item).find("td:eq(4) input").val(),merma.listaProducto.push(objlista)}),!!listaok&&("Sin Registros"==merma.listaProducto[0].idProducto&&(merma.listaProducto=[]),0==merma.listaProducto.length?(swal({type:"warning",title:"Seleccionar...",text:"Debe seleccionar la materia prima."}),!1):($("#btnMerma").attr("disabled","disabled"),void $.ajax({type:"POST",url:"class/mermaAgencia.php",data:{action:"Create",obj:JSON.stringify(this)}}).done(function(){merma.showInfo(),tp.rows().remove().draw()}).fail(function(e){producto.showError(e)}).always(function(){$("#btnMerma").removeAttr("disabled"),$("#p_searhProducto").focus()})))}}let merma=new MermaAgencia;var t;
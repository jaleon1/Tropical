class Bodega{constructor(id,nombre,descripcion,ubicacion,contacto,telefono,tipo){this.id=id||null,this.nombre=nombre||"",this.descripcion=descripcion||"",this.ubicacion=ubicacion||"",this.contacto=contacto||"",this.telefono=telefono||"",this.tipo=tipo||null}get tUpdate(){return this.update="update"}get tSelect(){return this.select="select"}set viewEventHandler(_t){this.viewType=_t}get Read(){NProgress.start();var miAccion=null==this.id?"ReadAll":"Read";"ReadAll"==miAccion&&0==$("#tBodega tbody").length||$.ajax({type:"POST",url:"class/Bodega.php",data:{action:miAccion,id:this.id}}).done(function(e){bodega.Reload(e)}).fail(function(e){bodega.showError(e)}).always(NProgress.done())}get Save(){NProgress.start(),$("#btnBodega").attr("disabled","disabled");var miAccion=null==this.id?"Create":"Update";this.nombre=$("#nombre").val(),this.descripcion=$("#descripcion").val(),this.ubicacion=$("#ubicacion").val(),this.contacto=$("#contacto").val(),this.telefono=$("#telefono").val(),this.tipo=$("#tipo option:selected").val(),$.ajax({type:"POST",url:"class/Bodega.php",data:{action:miAccion,obj:JSON.stringify(this)}}).done(bodega.showInfo).fail(function(e){bodega.showError(e)}).always(function(){$("#btnBodega").removeAttr("disabled"),(bodega=new Bodega).ClearCtls(),bodega.Read,$("#nombre").focus(),NProgress.done()})}get Delete(){$.ajax({type:"POST",url:"class/Bodega.php",data:{action:"Delete",id:this.id}}).done(function(){swal({type:"success",title:"Eliminado!",showConfirmButton:!1,timer:1e3})}).fail(function(e){bodega.showError(e)}).always(function(){(bodega=new Bodega).Read})}get ListTipos(){var miAccion="ListTipos";$.ajax({type:"POST",url:"class/Bodega.php",data:{action:miAccion}}).done(function(e){bodega.ShowListTipo(e)}).fail(function(e){bodega.showError(e)}).always(function(e){$("#tipo").selectpicker("refresh")})}get List(){var miAccion="List";$.ajax({type:"POST",url:"class/Bodega.php",data:{action:"List"}}).done(function(e){bodega.ShowList(e)}).fail(function(e){bodega.showError(e)}).always(function(e){$("#selbodega").selectpicker("refresh")})}get readByUser(){var miAccion="readByUser";$.ajax({type:"POST",url:"class/Bodega.php",data:{action:miAccion}}).done(function(e){bodega.ShowAllD(e)}).fail(function(e){bodega.showError(e)})}Reload(e){null==this.id?this.ShowAll(e):this.ShowItemData(e)}showInfo(){$(".close").click(),swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}showError(e){var data=JSON.parse(e.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+data.code+"): "+data.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}ClearCtls(){$("#id").val(""),$("#nombre").val(""),$("#descripcion").val(""),$("#ubicacion").val(""),$("#contacto").val(""),$("#telefono").val(""),$("#tipo option").prop("selected",!1)}ShowAll(e){var t=$("#tBodega").DataTable();0==t.rows().count()?(t.clear(),t.rows.add(JSON.parse(e)),t.draw(),$(document).on("click","#tBodega tbody tr td:not(.buttons)",null==bodega.viewType||bodega.viewType==bodega.tUpdate?bodega.UpdateEventHandler:bodega.SelectEventHandler),$(document).on("click",".delete",bodega.DeleteEventHandler),$(document).on("click",".openView",bodega.OpenEventHandler)):(t.clear(),t.rows.add(JSON.parse(e)),t.draw())}ShowAllD(e){b.clear(),b.rows.add(JSON.parse(e)),b.draw()}AddBodegaEventHandler(){bodega.id=$(this).find("td:eq(1)").html(),bodega.nombre=$(this).find("td:eq(2)").html(),bodega.descripcion=$(this).find("td:eq(3)").html(),bodega.tipo=$(this).find("td:eq(4)").html(),$("#nombre").val(bodega.nombre),$("#descripcion").val(bodega.descripcion),$("#tipo").val(bodega.tipo),$(".close").click()}OpenEventHandler(){var t=$("#tInsumo").DataTable();t.clear(),t.draw(),insumobodega.idBodega=$(this).parents("tr").find(".itemId").text(),insumobodega.ReadByBodega,$(".bs-insumo-modal-lg").modal("toggle"),$("#nombrebodega").text($(this).parents("tr").find("td:eq(1)").text())}UpdateEventHandler(){bodega.id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),bodega.Read}ShowItemData(e){this.ClearCtls();var data=JSON.parse(e)[0];bodega=new Bodega(data.id,data.nombre,data.descripcion,data.ubicacion,data.contacto,data.telefono,data.tipo),$("#id").val(bodega.id),$("#nombre").val(bodega.nombre),$("#myModalLabel").html("<h1>"+bodega.nombre+"<h1>"),$("#descripcion").val(bodega.descripcion),$("#ubicacion").val(bodega.ubicacion),$("#contacto").val(bodega.contacto),$("#telefono").val(bodega.telefono),$("#tipo option[value="+bodega.tipo+"]").prop("selected",!0),$("#tipo").selectpicker("refresh"),$(".bs-bodega-modal-lg").modal("toggle")}SelectEventHandler(){bodega.ClearCtls(),(bodega=new Bodega).id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),bodega.nombre=$(this).parents("tr").find("td:eq(1)").text()||$(this).find("td:eq(1)").text(),bodega.descripcion=$(this).parents("tr").find("td:eq(2)").text()||$(this).find("td:eq(2)").text(),bodega.tipo=$(this).parents("tr").find("td:eq(3)").text()||$(this).find("td:eq(3)").text(),$("#nombre").val(bodega.nombre),$("#descripcion").val(bodega.descripcion),$("#tipo").val(bodega.tipo),$(".bs-bodega-modal-lg").modal("toggle"),"Interna"==bodega.tipo?$("#frmTotales").hide():$("#frmTotales").show()}ShowListTipo(e){var data=JSON.parse(e);$.each(data,function(i,item){$("#tipo").append(`\n                <option value=${item.id}>${item.nombre}</option>\n            `)})}ShowList(e){var data=JSON.parse(e);$.each(data,function(i,item){$("#selbodega").append(`\n                    <option value=${item.id}>${item.nombre}</option>\n                `)})}DeleteEventHandler(){bodega.id=$(this).parents("tr").find(".itemId").text(),swal({title:"Eliminar?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(result=>{result.value&&bodega.Delete})}setTable(buttons=!0){$("#tBodega").DataTable({responsive:!0,info:!1,pageLength:10,order:[[1,"asc"]],language:{infoEmpty:"Sin Bodegas Registradas",emptyTable:"Sin Bodegas Registradas",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"NOBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"TIPO",data:"tipo"},{title:"ACCION",orderable:!1,searchable:!1,visible:buttons,className:"buttons",width:"5%",mRender:function(){return'<a class="delete" style="cursor: pointer;"> <i class="glyphicon glyphicon-trash"> </i> </a> | <a class="openView" style="cursor: pointer;"> <i class="glyphicon glyphicon-eye-open"> </i>  </a>'}}]})}Init(){var validator=new FormValidator({events:["blur","input","change"]},document.forms.frmBodega);$("#frmBodega").submit(function(e){var validatorResult;return e.preventDefault(),validator.checkAll(this).valid&&bodega.Save,!1}),document.forms.frmBodega.onreset=function(e){validator.reset()}}}let bodega=new Bodega;
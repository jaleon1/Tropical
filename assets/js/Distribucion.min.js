class Distribucion{constructor(t,a,e,o,i,r,s,d,n,l,c,u,p,b){this.id=t||null,this.orden=a||"",this.fecha=e||"",this.idUsuario=o||null,this.idBodega=i||null,this.bodega=n||null,this.porcentajeDescuento=r||0,this.porcentajeIva=s||0,this.totalImpuesto=u||0,this.totalComprobante=p||0,this.detalleFactura=d||[],this.fechaInicial=l||"",this.fechaFinal=c||"",this.tDistribucion=b||null}get tUpdate(){return this.update="update"}get tSelect(){return this.select="select"}set viewEventHandler(t){this.viewType=t}get Read(){NProgress.start();var t=null==this.id?"ReadAll":"Read";"ReadAll"==t&&0==$("#tDistribucion tbody").length||$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:t,id:this.id}}).done(function(t){distr.Reload(t)}).fail(function(t){distr.showError(t)}).always(NProgress.done())}get Save(){if(0!=$("#tDistribucion tbody tr").length){$("#btnDistribucion").attr("disabled","disabled");var t=null==distr.id?"Create":"Update";distr.totalVenta=0,distr.totalDescuentos=0,distr.totalVentaneta=0,distr.totalImpuesto=0,distr.totalComprobante=0,distr.detalleFactura=[],$("#tDistribucion tbody tr").each(function(t,a){var e=new Object;e.idProducto=$(a).find("td:eq(0)")[0].textContent,e.codigo=$(this).find("td:eq(1)").html(),e.valor=$(a).find("td:eq(6)").attr("value"),e.cantidad=parseFloat($(a).find("td:eq(5) input").val()),e.detalle=e.codigo,e.precioUnitario=parseFloat(parseFloat(e.valor).toFixed(5)),e.numeroLinea=t+1,e.idTipoCodigo=1,e.codigo=e.codigo,e.idUnidadMedida=78,e.montoTotal=parseFloat((e.precioUnitario*e.cantidad).toFixed(5)),e.montoDescuento=0,e.naturalezaDescuento="No aplican descuentos",e.subTotal=parseFloat((e.montoTotal-e.montoDescuento).toFixed(5)),e.impuestos=[];var o=0,i=new Object;i.idCodigoImpuesto=1,i.codigoTarifa=8,i.tarifa=13,i.monto=parseFloat((e.subTotal*(i.tarifa/100)).toFixed(5)),o+=i.monto,e.montoTotalLinea=parseFloat((e.subTotal+o).toFixed(5)),e.impuestos.push(i),distr.totalVenta=parseFloat((distr.totalVenta+e.montoTotal).toFixed(5)),distr.totalDescuentos=parseFloat((distr.totalDescuentos+e.montoDescuento).toFixed(5)),distr.totalImpuesto=parseFloat((distr.totalImpuesto+o).toFixed(5)),distr.detalleFactura.push(e)}),distr.totalServGravados=0,distr.totalServExentos=0,distr.totalMercanciasGravadas=distr.totalVenta,distr.totalMercanciasExentas=0,distr.totalGravado=parseFloat((distr.totalServGravados+distr.totalMercanciasGravadas).toFixed(5)),distr.totalExento=parseFloat((distr.totalServExentos+distr.totalMercanciasExentas).toFixed(5)),distr.totalVenta=parseFloat((distr.totalGravado+distr.totalExento).toFixed(5)),distr.totalVentaneta=parseFloat((distr.totalVenta-distr.totalDescuentos).toFixed(5)),distr.totalComprobante=parseFloat((distr.totalVentaneta+distr.totalImpuesto).toFixed(5)),distr.idReceptor=bodega.id,distr.orden=$("#orden").val(),distr.idBodega=bodega.id,distr.porcentajeDescuento=$("#desc_100").val(),distr.porcentajeIva=$("#iv_100").val(),$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:t,obj:JSON.stringify(this)}}).done(function(t){"NORECEPTOR"==JSON.parse(t)?swal({type:"warning",title:"Receptor",text:"Receptor no registrado para Facturación Electrónica",allowOutsideClick:!1}):"NOCONTRIB"==JSON.parse(t)?swal({type:"warning",title:"Contibuyente",text:"Emisor no registrado para Facturación Electrónica",allowOutsideClick:!1}):distr.ticketPrint(t)}).fail(function(t){distr.showError(t)}).always(function(){$("#btnDistribucion").removeAttr("disabled"),distr=new Distribucion,distr.CleanCtls(),$("#p_searh").focus()})}else swal({type:"warning",title:"Orden de Traslado",text:"Debe agregar items a la lista",showConfirmButton:!1,timer:3e3})}ticketPrint(t){"Interna"==bodega.tipo?localStorage.setItem("lsTipoBodega","interna"):localStorage.setItem("lsTipoBodega","externa");var a=JSON.parse(t);localStorage.setItem("lsRePrint",!1),localStorage.setItem("lsOrden",a.orden),localStorage.setItem("lsBodega",$("#nombre").val()),localStorage.setItem("lsDescripcion",$("#descripcion").val()),localStorage.setItem("lsSubTotal",$("#subtotal").text()),localStorage.setItem("lsTotal",$("#total").text()),localStorage.setItem("lsFechaDistribucion",a.fecha),localStorage.setItem("lsPorcentajeDescuento",$("#desc_val").text()),localStorage.setItem("lsIV",$("#iv_val").text()),localStorage.setItem("lsListaProducto",JSON.stringify(a.detalleFactura)),localStorage.setItem("lsUsuarioDistribucion",$("#call_username").text()),localStorage.setItem("lsClaveDis",a.clave),location.href="/TicketDistribucion.html"}ticketRePrint(){var t=[],a=0;"Externa"==bodega.tipo?localStorage.setItem("lsTipoBodega","externa"):localStorage.setItem("lsTipoBodega","interna"),$("#tb_detalle_distribucion tbody tr").each(function(){var e=new Object;e.cantidad=$(this).find("td:eq(2)").html(),e.codigo=$(this).find("td:eq(0)").html(),e.montoTotal=parseFloat($(this).find("td:eq(3)").html().replace("¢","").replace(",",""))*e.cantidad,e.montoTotal="¢"+parseFloat(e.montoTotal).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),a+=parseFloat($(this).find("td:eq(3)").html().replace("¢","").replace(",",""))*e.cantidad,t.push(e)}),localStorage.setItem("lsListaProducto",JSON.stringify(t)),localStorage.setItem("lsRePrint",!0),localStorage.setItem("lsSubTotal","¢"+parseFloat(a).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")),localStorage.setItem("lsIV","¢"+parseFloat(.13*a).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")),localStorage.setItem("lsTotal",$("#total").text()),localStorage.setItem("lsFechaDistribucion",$("#fechaDistribucion").text()),localStorage.setItem("lsBodega",$("#bodega").text()),localStorage.setItem("lsOrden",$("#consecutivo").text()),localStorage.setItem("lsUsuarioDistribucion",$("#call_username").text()),location.href="/TicketDistribucion.html"}get ReadbyOrden(){$("#orden").attr("disabled","disabled");var t="ReadbyOrden";distr.orden=$("#p_searh").val(),$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:t,obj:JSON.stringify(this)}}).done(function(t){"null"==t||""==t?swal({type:"warning",title:"Orden no encontrada!",title:"La Orden no existe o no se encuentra disponible para esta bodega.",showConfirmButton:!1,timer:3e3}):distr.ShowOrderData(t)}).fail(function(t){distr.showError(t)}).always(function(){$("#orden").removeAttr("disabled")})}Aceptar(){$("#btnDistribucion").attr("disabled","disabled");var t="Aceptar";distr.detalleFactura=[],$("#tDistribucion tbody tr").each(function(t,a){var e=new Object;e.idProducto=$(a).find("td:eq(0)")[0].textContent,e.cantidad=$(a).find("td:eq(5) input").val(),e.costo=$(a).find("td:eq(6)").attr("value"),e.valor=parseFloat(parseInt(e.cantidad)*parseFloat(e.costo)),distr.detalleFactura.push(e)}),$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:t,obj:JSON.stringify(this)}}).done(distr.showInfo).fail(function(t){distr.showError(t)}).always(function(){$("#btnDistribucion").removeAttr("disabled"),distr=new Distribucion,distr.CleanCtls(),$("#p_searh").focus()})}Reload(t){null==this.id?this.ShowAll(t):this.ShowItemData(t)}ShowAll(t){var a=$("#tDistribucion").DataTable();a.clear(),a.rows.add(JSON.parse(t)),a.order([1,"desc"]).draw()}ShowOrderData(t){this.CleanCtls();var a=JSON.parse(t);distr=new Distribucion(a.id,a.orden,a.fecha,a.idUsuario,a.idBodega,a.porcentajeDescuento,a.porcentajeIva,a.detalleFactura),$("#orden").val(distr.orden),$("#fecha").val(distr.fecha),bodega.id=distr.idBodega,bodega.Read,$.each(distr.detalleFactura,function(t,a){producto=a,distr.AgregaProducto()})}ShowItemData(t){$("#mensajeRechazo").text("");var a=JSON.parse(t);localStorage.setItem("lsClaveDis",a.clave),distr=new Distribucion(a.id,a.orden,a.fecha,a.idUsuario,a.idBodega,a.porcentajeDescuento,a.porcentajeIva,a.detalleFactura,a.bodega),distr.totalComprobante=a.totalComprobante,distr.totalImpuesto=a.totalImpuesto;var e=null;$("#detalleDistribucion").empty(),e=a.orden==a.idReferencia?`<button type="button" class="close" data-dismiss="modal">\n                <span aria-hidden="true">X</span>\n            </button>\n            <h4 class="modal-title" id="myModalLabel">Traslado #<label id=consecutivo>${distr.orden}</label></h4>\n            <div class="row">\n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Fecha: <label id=fechaDistribucion>${distr.fecha}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Destino: <label id=bodega>${distr.bodega}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>TOTAL: <label id=total>${"¢"+parseFloat(distr.totalComprobante).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,".")}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Clave Factura: <label id=clave>${a.clave}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Clave Nota de Credito: <label id=claveNC>${a.claveNC}</label></p>\n                </div>\n            </div>`:`<button type="button" class="close" data-dismiss="modal">\n                <span aria-hidden="true">X</span>\n            </button>\n            <h4 class="modal-title" id="myModalLabel">Traslado #<label id=consecutivo>${distr.orden}</label></h4>\n            <div class="row">\n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Fecha: <label id=fechaDistribucion>${distr.fecha}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Destino: <label id=bodega>${distr.bodega}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>TOTAL: <label id=total>${"¢"+parseFloat(distr.totalComprobante).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,".")}</label></p>\n                </div>\n            </div>\n            <div class="row">                \n                <div class="col-md-6 col-sm-6 col-xs-6">\n                    <p>Clave Factura: <label id=clave>${a.clave}</label></p>\n                </div>\n            </div>`,$("#detalleDistribucion").append(e),$("#totalDistribucion").empty(),this.tb_prdXFact=$("#tb_detalle_distribucion").DataTable({data:distr.detalleFactura,destroy:!0,searching:!1,paging:!1,info:!1,ordering:!1,order:[[0,"desc"]],columns:[{title:"CODIGO",data:"codigo"},{title:"NOMBRE",data:"nombre"},{title:"CANTIDAD",data:"cantidad"},{title:"PRECIO VENTA",data:"montoTotal",className:"text-right",mRender:function(t){return"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"IV",data:"montoImpuesto",className:"text-right",mRender:function(t){return"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}},{title:"SUBTOTAL",data:"subTotal",className:"text-right",mRender:function(t){return"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,",")}}]}),distr.ReadRespuestaRachazo(a.id,a.idEstadoComprobante,a.idEstadoNC),$("#modalDistribucion").modal("toggle")}showInfo(){$(".close").click(),swal({type:"success",title:"Listo!",showConfirmButton:!1,timer:1e3})}showError(t){var a=JSON.parse(t.responseText);swal({type:"error",title:"Oops...",text:"Algo no está bien ("+a.code+"): "+a.msg,footer:"<a href>Contacte a Soporte Técnico</a>"})}CleanCtls(){$("#p_searh").val(""),$("#proveedor").val(""),$("#orden").val("");var t=$("#tDistribucion").DataTable();t.rows().remove().draw(),$("#subtotal")[0].textContent="¢0",$("#desc_val")[0].textContent="¢0",$("#iv_val")[0].textContent="¢0",$("#total")[0].textContent="¢0",$("#nombre").val(""),$("#descripcion").val("")}ResetSearch(){$("#p_searh").val("")}LoadProducto(){""!=$("#p_searh").val()&&(NProgress.start(),$("#p_searh").attr("disabled","disabled"),producto.codigo=$("#p_searh").val(),$.ajax({type:"POST",url:"class/Producto.php",data:{action:"ReadByCode",obj:JSON.stringify(producto)}}).done(function(t){distr.ResetSearch(),distr.ValidateProductoFac(t)}).fail(function(t){distr.showError(t)}).always(function(){$("#p_searh").removeAttr("disabled"),$("#p_searh").focus(),NProgress.done()}))}ValidateProductoFac(t){if("false"!=t){producto=JSON.parse(t)[0];var a=$("#tDistribucion tbody tr td").filter(function(){return $(this).text()==producto.id}).length;producto.saldoCantidad<=0?swal({type:"warning",title:"Determinación de Producto",text:"El producto No tiene Saldo.",showConfirmButton:!1,timer:3e3}):0==a?distr.AgregaProducto():swal({type:"warning",title:"El producto "+producto.codigo+" ya está en la lista.",showConfirmButton:!1,timer:3e3})}else swal({type:"warning",title:"El producto "+producto.codigo+" NO existe.",showConfirmButton:!1,timer:3e3})}AgregaProducto(){var t=$("#tDistribucion").DataTable(),a=t.row.add(producto).draw().node();$("td:eq(4)",a).attr({id:"saldoCantidad"+producto.id,value:producto.saldoCantidad,align:"right"})[0].textContent=parseFloat(producto.saldoCantidad).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),$("td:eq(5) input",a).attr({id:"cantidad"+producto.id,max:producto.saldoCantidad,min:"1",step:"1",value:producto.cantidad||1}).on("keyup keypress mouseup",function(t){var a=t.keyCode||t.which;if(109==a)return t.preventDefault(),!1;distr.setProducto($(this).parents("tr").find("td:eq(0)").html()),producto.saldoCantidad<producto.cantidad&&(swal({type:"warning",title:"Saldo Insuficiente",text:"El producto contiene unicamente "+producto.saldoCantidad+" unidades",showConfirmButton:!1,timer:3e3}),$(this).val(producto.saldoCantidad),distr.setProducto($(this).parents("tr").find("td:eq(0)").html())),distr.CalcImporte()}),$("td:eq(6)",a).attr({id:"precioVenta"+producto.id,value:producto.precioVenta/1.13,align:"right"})[0].textContent="¢"+parseFloat(producto.precioVenta/1.13).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),$("td:eq(7)",a).attr({id:"subtotal"+producto.id,value:0,align:"right"})[0].textContent=0,t.columns.adjust().draw(),distr.setProducto(producto.id),distr.CalcImporte()}UpdateEventHandler(){distr.id=$(this).parents("tr").find(".itemId").text()||$(this).find(".itemId").text(),"Externa"==$(this).parents("tr").find("td:eq(7)").text()?bodega.tipo="Externa":bodega.tipo="Interna",distr.Read}DeleteEventHandler(t){var a=$("#tDistribucion").DataTable();a.row($(t).parents("tr")).remove().draw(),distr.setProducto($(t).parents("tr").find("td:eq(0)").html()),distr.calcTotal()}DeleteDistr(t){distr.estado=$(t).parents("tr").find("td:eq(6)").text(),"LIQUIDADO"!=distr.estado?swal({type:"warning",title:"Distribución",text:"No es posible Eliminar una orden de Distribución sin ACEPTAR o CANCELADA.",allowOutsideClick:!1}):swal({title:"Eliminar?",text:"Esta acción es irreversible!",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Si, eliminar!",cancelButtonText:"No, cancelar!",confirmButtonClass:"btn btn-success",cancelButtonClass:"btn btn-danger"}).then(a=>{a.value&&(distr.id=$(t).parents("tr").find(".itemId").text(),distr.orden=$(t).parents("tr").find("td:eq(2)").text(),$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:"Delete",id:distr.id,orden:distr.orden}}).done(distr.showInfo).fail(function(t){distr.showError(t)}).always(function(){distr=new Distribucion,distr.CargaTrasladosRango()}))})}setProducto(t){producto.id=t,producto.saldoCantidad=parseFloat($(`#saldoCantidad${t}`).attr("value")),producto.cantidad=$(`#cantidad${t}`).val(),producto.precioVenta=parseFloat($(`#precioVenta${t}`).attr("value")),producto.subtotal=(producto.cantidad*producto.precioVenta).toFixed(10)}CalcImporte(){$(`#subtotal${producto.id}`).attr({value:producto.subtotal}),$(`#subtotal${producto.id}`)[0].textContent="¢"+parseFloat(producto.subtotal).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),distr.calcTotal()}calcTotal(){var t=0;distr.porcentajeDescuento=0,distr.porcentajeIva=13,$("#desc_100").val(distr.porcentajeDescuento),$("#iv_100").val(distr.porcentajeIva),$("#subtotal")[0].textContent="¢0",$("#desc_val")[0].textContent="¢0",$("#iv_val")[0].textContent="¢0",$("#total")[0].textContent="¢0",$("#tDistribucion tr").find("td:eq(7)").each(function(a,e){t+=parseFloat($(e).attr("value"))}),t>0&&($("#subtotal")[0].textContent="¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),distr.descuento=t*(parseFloat(distr.porcentajeDescuento)/100),$("#desc_val")[0].textContent="¢"+parseFloat(distr.descuento).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),distr.iva=t*(parseFloat(distr.porcentajeIva)/100),$("#iv_val")[0].textContent="¢"+parseFloat(distr.iva).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","),distr.totalComprobante=t-distr.descuento+distr.iva,$("#total")[0].textContent="¢"+parseFloat(distr.totalComprobante).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","))}setTable(t=!0,a=10){$("#tDistribucion").DataTable({responsive:!0,info:!1,iDisplayLength:a,paging:!1,language:{infoEmpty:"Sin Productos Ingresados",emptyTable:"Sin Productos Ingresados",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},columnDefs:[{className:"text-center",targets:[4]}],columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"CODIGO",data:"codigo"},{title:"NOMBRE",data:"nombre"},{title:"DESCRIPCION",data:"descripcion"},{title:"SALDO CANTIDAD",data:"saldoCantidad"},{title:"CANTIDAD",data:"cantidad",mRender:function(){return'<input class="cantidad form-control" type="number" min="1" max="9999999999" step="1" style="text-align:right;" >'}},{title:"PRECIO VENTA",data:"precioVenta"},{title:"SUBTOTAL",data:null},{title:"ACCION",orderable:!1,searchable:!1,visible:t,className:"buttons",width:"5%",mRender:function(){return'<a class="delete" onclick="distr.DeleteEventHandler(this)" style="cursor: pointer;"> <i class="glyphicon glyphicon-trash"> </i>  </a>'}}]})}sendContingenciaMasiva(){$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:"sendContingenciaMasiva"}}).done(function(t){distr.CargaTrasladosRango()})}drawDistribucion(t){var a=JSON.parse(t);$("#tDistribucion").DataTable({footerCallback:function(t,a,e,o,i){var r=this.api(),s=function(t){return"string"==typeof t?parseFloat(t.replace(/[\¢,]/g,"")):"number"==typeof t?t:0},d=i.map(t=>a[t].totalComprobante).reduce((t,a)=>s(t)+s(a),0);$(r.column(1).footer()).html("TOTALES"),$(r.column(5).footer()).html("¢"+parseFloat(Number(d)).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,","))},responsive:!0,destroy:!0,order:[[1,"desc"]],dom:"Bfrtip",buttons:[{extend:"excelHtml5",exportOptions:{columns:[1,2,3,4,5,6]},messageTop:"Traslados y facturación"},{extend:"pdfHtml5",messageTop:"Traslados y facturación",exportOptions:{columns:[1,2,3,4,5,6]}}],language:{infoEmpty:"Sin Traslados Registrados",emptyTable:"Sin Traslados Registrados",search:"Buscar",zeroRecords:"No hay resultados",lengthMenu:"Mostrar _MENU_ registros",paginate:{first:"Primera",last:"Ultima",next:"Siguiente",previous:"Anterior"}},data:a,columns:[{title:"ID",data:"id",className:"itemId",searchable:!1},{title:"FECHA",data:"fecha"},{title:"ORDEN",data:"orden"},{title:"USUARIO",data:"userName"},{title:"BODEGA",data:"bodega"},{title:"TOTAL",data:"totalComprobante",className:"text-right",mRender:function(t){return"¢"+parseFloat(t).toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g,".")}},{title:"ESTADO",data:"idEstadoComprobante",render:function(t,a,e,o){if(null!=e.claveNC&&(t=e.idEstadoNC),"Interna"==e.tipoBodega)return'<i class="fa fa-check-square-o" aria-hidden="true" style="color:green"> Interna</i>';switch(t){case"1":return'<i class="fa fa-paper-plane" aria-hidden="true" style="color:red"> Sin Enviar</i>';case"2":return'<i class="fa fa-paper-plane" aria-hidden="true" style="color:green"> Enviado</i>';case"3":return'<i class="fa fa-check-square-o" aria-hidden="true" style="color:green"> Aceptado</i>';case"4":return'<i class="fa fa-times-circle" aria-hidden="true" style="color:red"> Rechazado</i>';case"5":return'<i class="fa fa-exclamation-triangle" aria-hidden="true" style="color:#FF6F00"> Otro</i>';case"99":return'<i class="fa fa-exclamation-triangle" aria-hidden="true" style="color:green"> Reportado</i>';default:return"Desconocido"}}},{title:"TIPO BODEGA",data:"tipoBodega"},{title:"ACCION",className:"buttons",data:"claveNC",render:function(t,a,e,o){if("Interna"==e.tipoBodega)return"<button class=btn_ReversarDistribucionInterna>&nbsp Cancelar Interna</button>";if(null!=t)return'<i class="fa fa-check-square-o" aria-hidden="true" style="color:green">Factura Cancelada por NC!</i>';switch(e.idEstadoComprobante){case"1":return"<button class=btnEnviarFactura>&nbsp Enviar</button>";case"2":return'<i class="fa fa-check-square-o">&nbsp Enviada</i>';case"3":return"<button class=btnCancelaFactura>&nbsp Cancelar Factura</button>";case"4":return"<button class=btnNC_CreateFact_Ref>&nbsp Cancelar & Reenviar</button>";case"5":return'<i class="fa fa-cloud-upload" aria-hidden="true">&nbsp Enviar Contingencia</i>';default:return"<button>Soporte</button>"}}},{title:"ESTADO NC",data:"idEstadoNC",visible:!1}]})}CargaTrasladosRango(){var t=distr.tDistribucion;distr.tDistribucion=[],$.ajax({type:"POST",url:"class/Distribucion.php",data:{action:"ReadAllbyRange",obj:JSON.stringify(distr)}}).done(function(a){distr.tDistribucion=t,distr.drawDistribucion(a)}).fail(function(t){distr.showError(t)})}ReadRespuestaRachazo(t,a,e){var o="",i=parseInt(a),r=parseInt(e);if(i<=3||r<=3)return!1;$.ajax({type:"POST",url:"class/Factura.php",data:{action:"ReadRespuestaRachazo",id:t}}).done(function(t){" []"!=t&&(o=JSON.parse(t),$("#mensajeRechazo").text(""),$("#mensajeRechazo").append(o[0].respuesta))})}}let distr=new Distribucion;$("#tb_facturasExternas tbody").on("click","td",function(){inventarioFacturas.ReadbyID(inventarioFacturas.tb_facturas.row(this).data())});